<!--
  ~ Copyright (C) 2017/2021 e-voyageurs technologies
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<nb-card
  class="mt-3"
  [nbSpinner]="loading"
>
  <nb-card-body>
    <table
      *ngIf="dataSource && dataSource.length !== 0"
      class="table-logs mb-2"
    >
      <thead>
        <tr>
          <th>Date</th>
          <th>Type</th>
          <th>User</th>
          <th>Application</th>
          <th>Data</th>
          <th>Error</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of dataSource; index as i">
          <td>{{ row.date | amDateFormat: 'YYYY-MM-DD HH:mm' }}</td>
          <td>{{ row.actionType }}</td>
          <td>{{ row.login }}</td>
          <td>{{ appName(row.applicationId) }}</td>
          <td>
            <button
              *ngIf="row.newData"
              nbButton
              ghost
              shape="round"
              size="small"
              (click)="displayData(row)"
            >
              <nb-icon icon="eye-outline"></nb-icon>
            </button>
          </td>
          <td>
            <nb-icon
              *ngIf="row.error"
              icon="alert-circle"
              size="small"
              status="danger"
            ></nb-icon>
          </td>
        </tr>
      </tbody>
    </table>
    <div
      *ngIf="dataSource && dataSource.length !== 0"
      class="d-flex justify-content-center"
    >
      <nb-select
        [(ngModel)]="pageSize"
        (selectedChange)="search()"
        nbTooltip="Items per page:"
      >
        <nb-option [value]="10">10</nb-option>
        <nb-option [value]="20">20</nb-option>
        <nb-option [value]="50">50</nb-option>
      </nb-select>
      <ngb-pagination
        [collectionSize]="totalSize"
        [(page)]="pageIndex"
        [maxSize]="10"
        [pageSize]="pageSize"
        (pageChange)="search()"
      >
      </ngb-pagination>
    </div>
  </nb-card-body>
</nb-card>
