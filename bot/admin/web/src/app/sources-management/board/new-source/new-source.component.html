<nb-card class="main-card">
  <nb-card-header class="d-flex justify-content-between align-items-start gap-1">
    <span *ngIf="!source"> New source </span>
    <span *ngIf="source"> Edit source &laquo;{{ source.name }}&raquo; </span>
    <button
      nbButton
      ghost
      shape="round"
      nbTooltip="Cancel"
      (click)="cancel()"
    >
      <nb-icon icon="close-outline"></nb-icon>
    </button>
  </nb-card-header>

  <nb-card-body>
    <form [formGroup]="form">
      <tock-form-control
        label="Source name"
        name="name"
        [controls]="name"
        [showError]="isSubmitted"
        [required]="true"
      >
        <input
          tockAutofocusElement
          nbInput
          formControlName="name"
          id="name"
          fullWidth
          type="text"
          placeholder="Enter source name"
        />
      </tock-form-control>

      <tock-form-control
        label="Source description"
        name="description"
        [controls]="description"
        [showError]="isSubmitted"
      >
        <textarea
          nbInput
          formControlName="description"
          fullWidth
          type="text"
          placeholder="Enter source description"
        ></textarea>
      </tock-form-control>

      <tock-form-control
        label="Source type"
        name="type"
        [controls]="source_type"
        [showError]="isSubmitted"
        [required]="true"
      >
        <nb-radio-group [formControl]="source_type">
          <nb-radio [value]="sourceTypes.file"> File import </nb-radio>
          <nb-radio [value]="sourceTypes.remote"> Remote source </nb-radio>
        </nb-radio-group>
      </tock-form-control>

      <div formGroupName="source_parameters">
        <tock-form-control
          *ngIf="source_type.value === sourceTypes.remote"
          label="Source url"
          name="source_url"
          [controls]="source_url"
          [showError]="isSubmitted"
          [required]="true"
        >
          <input
            nbInput
            formControlName="source_url"
            fullWidth
            type="url"
            placeholder="Enter source url"
          />
        </tock-form-control>
      </div>
    </form>
  </nb-card-body>

  <nb-card-footer>
    <div class="d-flex justify-content-between">
      <button
        type="button"
        nbButton
        outline
        status="primary"
        size="small"
        (click)="cancel()"
      >
        Cancel
      </button>
      <button
        type="button"
        nbButton
        status="primary"
        size="small"
        [disabled]="!canSave"
        (click)="saveNewSource()"
      >
        Save
      </button>
    </div>
  </nb-card-footer>
</nb-card>
