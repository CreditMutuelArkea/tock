<nb-card id="modal-wrapper">
  <nb-card-header class="d-flex justify-content-between align-items-start">
    <h4>Api call definition</h4>

    <button
      nbButton
      ghost
      shape="round"
      nbTooltip="Cancel"
      (click)="cancel()"
      class="ml-3"
    >
      <nb-icon icon="close-outline"></nb-icon>
    </button>
  </nb-card-header>

  <nb-card-body>
    <form
      [formGroup]="form"
      (submit)="save()"
    >
      <div class="d-flex flex-column mb-2">
        <label for="description">Description</label>
        <textarea
          nbInput
          formControlName="description"
          fullWidth
          id="description"
          type="text"
          placeholder="Enter description"
        ></textarea>
      </div>

      <div class="d-flex flex-column mb-2">
        <label for="name">Endpoint name <span class="text-muted">(*)</span></label>
        <input
          #nameInput
          nbInput
          formControlName="name"
          fullWidth
          id="name"
          type="text"
          placeholder="Enter endpoint name"
        />
      </div>

      <div class="d-flex flex-column mb-2">
        <label for="description">Response type <span class="text-muted">(*)</span></label>
        <nb-select
          placeholder="Select api call response type"
          formControlName="responseType"
        >
          <nb-option [value]="SCENARIO_ITEM_API_RESPONSETYPE_STRING">Text or Number</nb-option>
          <nb-option [value]="SCENARIO_ITEM_API_RESPONSETYPE_BOOLEAN">Boolean</nb-option>
          <nb-option [value]="SCENARIO_ITEM_API_RESPONSETYPE_CODES">Response codes</nb-option>
        </nb-select>
      </div>

      <div
        class="d-flex flex-column mb-2"
        *ngIf="form.value.responseType == 'codes'"
      >
        <label for="description">Response codes <span class="text-muted">(*)</span></label>
        <ul>
          <li
            *ngFor="let code of responseCodes.value"
            class="d-flex justify-content-between align-items-start"
          >
            <div class="text-muted">
              {{ code }}
            </div>
            <div>
              <nb-icon
                icon="trash-2-outline"
                status="danger"
                (click)="removeResponseCode(code)"
                class="pointer"
                nbTooltip="Remove this response code"
              ></nb-icon>
            </div>
          </li>
        </ul>

        <input
          #labelInput
          nbInput
          fullWidth
          id="newQuestion"
          type="text"
          placeholder="Add a code and press enter"
          class="mt-2"
          fieldSize="small"
          (keyup.enter)="addResponseCode($event)"
        />
      </div>
    </form>
  </nb-card-body>

  <nb-card-footer class="d-flex justify-content-between">
    <button
      nbButton
      size="small"
      status="basic"
      class="m-1"
      (click)="cancel()"
    >
      Cancel
    </button>

    <button
      nbButton
      size="small"
      status="danger"
      class="m-1"
      (click)="removeApiDefinition()"
      *ngIf="item.apiCallDefinition"
    >
      <nb-icon icon="slash-outline"></nb-icon>
      Delete api call definition
    </button>

    <button
      nbButton
      size="small"
      status="primary"
      class="m-1"
      (click)="save()"
      [disabled]="!canSave"
    >
      <nb-icon icon="save-outline"></nb-icon>
      Save
    </button>
  </nb-card-footer>
</nb-card>
