<nb-card id="modal-wrapper">
  <nb-card-header class="d-flex justify-content-between align-items-center">
    <h4>Action definition</h4>

    <button
      nbButton
      ghost
      shape="round"
      nbTooltip="Cancel"
      (click)="cancel()"
      class="ml-3"
    >
      <nb-icon icon="close-outline"></nb-icon>
    </button>
  </nb-card-header>

  <nb-card-body>
    <form
      [formGroup]="form"
      (submit)="save()"
    >
      <div class="row main-row">
        <div class="col-6">
          <div class="mb-3">
            <label for="name">Name <span class="text-muted">(*)</span></label>
            <input
              nbInput
              formControlName="name"
              fullWidth
              id="name"
              type="text"
              placeholder="Enter endpoint name"
              (blur)="formatActionName()"
            />
          </div>

          <div class="mb-3">
            <label for="description">Description</label>
            <textarea
              nbInput
              formControlName="description"
              fullWidth
              id="description"
              placeholder="Enter description"
              rows="5"
            ></textarea>
          </div>
          <div class="mb-3">
            <label for="handler">Api handler</label>
            <input
              nbInput
              formControlName="handler"
              fullWidth
              id="handler"
              type="text"
              placeholder="Enter handler class name"
            />
          </div>

          <div class="mb-3">
            <label for="answer">Answer</label>
            <textarea
              nbInput
              formControlName="answer"
              fullWidth
              id="answer"
              placeholder="Enter answer"
              rows="5"
            ></textarea>
          </div>
        </div>

        <div class="col-6">
          <div class="mb-3">
            <label for="inputContexts">Input contexts</label>
            <input
              nbInput
              fullWidth
              id="inputContexts"
              type="text"
              placeholder="Add an input context and press enter"
              (keyup.enter)="addContext('input', $event)"
            />

            <nb-list>
              <nb-list-item
                *ngFor="let inputContext of inputContexts.value"
                class="p-2 d-flex justify-content-between"
              >
                {{ inputContext }}
                <nb-icon
                  icon="trash-2-outline"
                  status="danger"
                  (click)="removeContext('input', inputContext)"
                  class="pointer"
                  nbTooltip="Remove this context"
                ></nb-icon>
              </nb-list-item>
            </nb-list>
          </div>

          <div class="mb-3">
            <label for="outputContexts">Output contexts</label>
            <input
              nbInput
              fullWidth
              id="outputContexts"
              type="text"
              placeholder="Add an output context and press enter"
              (keyup.enter)="addContext('output', $event)"
            />
            <nb-list>
              <nb-list-item
                *ngFor="let outputContext of outputContexts.value"
                class="p-2 d-flex justify-content-between"
              >
                {{ outputContext }}
                <nb-icon
                  icon="trash-2-outline"
                  status="danger"
                  (click)="removeContext('input', outputContext)"
                  class="pointer"
                  nbTooltip="Remove this context"
                ></nb-icon>
              </nb-list-item>
            </nb-list>
          </div>
        </div>
      </div>
    </form>
  </nb-card-body>

  <nb-card-footer class="d-flex justify-content-between">
    <button
      nbButton
      size="small"
      status="basic"
      class="m-1"
      (click)="cancel()"
    >
      Cancel
    </button>

    <button
      nbButton
      size="small"
      status="danger"
      class="m-1"
      (click)="removeActionDefinition()"
      *ngIf="item.tickActionDefinition"
    >
      <nb-icon icon="slash-outline"></nb-icon>
      Delete action definition
    </button>

    <button
      nbButton
      size="small"
      status="primary"
      class="m-1"
      (click)="save()"
      [disabled]="!canSave"
    >
      <nb-icon icon="save-outline"></nb-icon>
      Save
    </button>
  </nb-card-footer>
</nb-card>
